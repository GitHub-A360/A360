{"triggers":[],"nodes":[{"uid":"af0a8f24-ec59-4864-964d-0ab58fc8ada9","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"cbc43e8c-0d38-4046-b493-7ed1da0d09ff","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"7081d3d5-46e8-4988-85f9-2cda7e03cd88","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Name: 1.2.0 Retrieve Email from IMAP Server"}}]},{"uid":"ca47eb07-17a0-4d7e-a771-eb6a40c8304b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task description: This task downloads attachments from the inbox.  If a duplicate input email is found, an exception notification is sent."}}]},{"uid":"43e5ac0d-8d4b-43cd-8498-9043418c5fb7","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Dependecies: 1.0.0 Posting Instructions to Eagle Master Task"}}]},{"uid":"31ae7c0a-cc2a-4f33-9284-c45b45f4e2a6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Modified By: Mike Garner"}}]},{"uid":"408b4ac9-3c69-4006-81fd-3328499b64b9","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Date Modified: "}}]},{"uid":"66d04f39-01d4-4575-9520-65f9ae6f8ac5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"99258f77-eb7b-4b50-86c1-93c0679df013","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"19b09d30-2034-48e1-91ec-7229914242db","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"44a8a757-8e2d-4709-bee1-419e740f2719","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Private Asset Class (PE, SI, RE) Posting Instructions"}}],"returnTo":{"type":"VARIABLE","variableName":"vTargetEmailSubject"}},{"uid":"88161247-fd4a-4fd3-9506-0787c339becb","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\garner_mike\\Desktop\\Input"}}],"returnTo":{"type":"VARIABLE","variableName":"vInputPath"}},{"uid":"5eed30c3-4302-46d7-9a86-d48b997615ef","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"BOT@example.com"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailFrom"}},{"uid":"066b64d3-be81-4eb6-9328-c748bc217cef","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"mike.garner@sbafla.com"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessEmail"}},{"uid":"df71a231-e456-465c-a962-f824ba9f29a5","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Duplicate email found"}}],"returnTo":{"type":"VARIABLE","variableName":"vDuplicateEmailExceptionSubject"}},{"uid":"493ccfc5-32b0-4bae-9ddc-44f47a2be856","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Two emails were received and only one was processed"}}],"returnTo":{"type":"VARIABLE","variableName":"vDuplicateEmailExceptionBody"}},{"uid":"81ed2935-63b7-416d-b274-c12e0fe13e77","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Invalid attachment found"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvalidAttachmentExceptionSubject"}},{"uid":"73874c4a-fb68-481d-aedf-8de348a7ebae","commandName":"toString","packageName":"Datetime","disabled":true,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"e63eeaa7-d207-4a99-8d4c-f8512ebbecc8","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"An invalid attachment was found in the email processed at $m-date-string$.  Please see attached."}}],"returnTo":{"type":"VARIABLE","variableName":"vInvalidAttachmentExceptionBody"}},{"uid":"b46ec498-7987-4830-8216-193f35cd5e93","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Out of Scope Attachments.zip"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvalidAttachmentArchiveName"}},{"uid":"9c3079c6-99ed-405c-bcd8-ac7bdbbfe825","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\garner_mike\\Documents\\Automation Anywhere Files\\Temp\\Eagle Process Working Folder"}}],"returnTo":{"type":"VARIABLE","variableName":"vWorkingFolder"}},{"uid":"6978247e-f037-441a-9335-d8f337feda83","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\garner_mike\\Documents\\Automation Anywhere Files\\Temp\\Eagle Process Temporary Folder"}}],"returnTo":{"type":"VARIABLE","variableName":"vTemporaryFolder"}},{"uid":"c7e9e422-c9c6-4f5c-b4e3-e8dd50f63aa6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"692e83d3-f02c-4b86-939e-2c0a39db75b6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**************************************************************************************************************************************************************************"}}]},{"uid":"feb0c5cf-3a12-4046-9fb1-c8d848f7c383","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"a4442267-5926-45bd-b095-54fea8a4a006","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"244e2f10-360e-4009-ad8d-f44e300b514c","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"4d60c08f-1b26-4431-84ec-2c919720005e","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"fd21efe7-7cec-4e9c-a1e1-2ab176dc8803","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"bd4e3f55-ea8a-4cdf-abab-dd0d86015cb9","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"a2a58d72-1d8d-4cb5-9f76-a57614562efe","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Retrieve attachments from IMAP server"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"5367950b-6616-457e-8f90-69f8ab1b84c8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Started"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"229e1fdd-247b-4d77-8657-27bde9c84750","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"328375ed-1d1a-4ea9-b191-1d6c271d4c26","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"80adc636-abbf-4c14-827f-4db5109176cf","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]},{"uid":"f83a3a98-2a19-4ac0-a6a5-0516e1b11ba6","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"7c5671c4-4b24-44cd-a498-b477b9a5cb2e","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"c5bd0f06-a6dc-494f-b6ca-254fc91d1395","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"a853ac20-1e85-4f67-8ee0-405795322a2e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Connecting to IMAP server to retrieve mail"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"6c60ceef-b986-4357-a4db-d1ce9da3cb31","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Started"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"5614efd9-f065-4c4e-9526-1617d84315ef","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"fece4241-d185-41ce-a035-0b9f83cb22e1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"06fd034a-6ce4-4ff6-85cf-940078ec169c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]},{"uid":"9988aaa5-74b6-41ba-8128-e88d5758056a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"5d9a0165-116a-4075-a9c8-9cfbd5f1a2a5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ba559562-db54-4530-b86d-018ea3672291","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession-1"}},{"name":"serverType","value":{"type":"STRING","string":"EWS"}},{"name":"ewsUsername","value":{"type":"STRING","string":"SBA.RPA009@sbafla.com"}},{"name":"ewsSecuredPassword","value":{"type":"STRING","string":"On\\H&P;X5$FwW:v2dbf4IdW~"}},{"name":"domain","value":{"type":"STRING","string":""}},{"name":"exchangeService","value":{"type":"STRING","string":"Exchange2010"}},{"name":"authType","value":{"type":"STRING","string":"OAuth2"}},{"name":"clientId","value":{"type":"STRING","string":"9e411784-a992-4670-a767-a09705caa8cd"}},{"name":"tenantId","value":{"type":"STRING","string":"f51e233e-f153-41f3-931f-987da82e38af"}},{"name":"desktopOperationButtonAttribute","value":{"type":"STRING"}}]}],"branches":[{"uid":"e4f21fa0-a495-4c2a-9ee7-341f87e59fd5","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"db3974d3-fb3e-4263-8989-6072c0e821c8","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession-1"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"serverHost","value":{"type":"STRING","expression":"$vIMAPserver$"}},{"name":"port","value":{"type":"NUMBER","number":"993"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"RPA 003 Mailbox","lockerName":"FinOps","attributeName":"vRPAMailboxUsername"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"RPA 003 Mailbox","lockerName":"FinOps","attributeName":"vRPAMailboxPassword"}}},{"name":"useSecure","value":{"type":"BOOLEAN","boolean":true}},{"name":"protocol","value":{"type":"STRING","string":"IMAP"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDevStageControlRoomURL$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$System:AAControlRoom$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"7db45703-7008-4fe5-8187-b39b1203575e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"611e32b0-bf3f-4327-b821-39ffda2f0b6f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"76559457-6b63-4174-98a4-7f85db205e51","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"folderPath","value":{"type":"STRING","expression":"$vTemporaryFolder$"}}]},{"uid":"6706ebbf-b78c-44ce-a8fa-f0b8239f18ef","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"The bot is comparing the current email subject with the vTargetSubject.  This is currently set to \"Private Asset Class (PE, SI, RE) Posting Instructions\" in the config file."}}]},{"uid":"4f384c5b-9fb8-46aa-a2f2-e9d16ff35462","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3ebce4df-32c4-46d1-b466-957ec1ed974c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If the vPriorMatch flag is set, the bot knows an email with the subject matching vTargetSubject was already processed."}}]},{"uid":"c1917f6f-dafd-43e1-b663-b9c2c7caa9b5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"447a980a-b58e-4f0a-9b88-5bc02aa7eff0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"T"}}],"returnTo":{"type":"VARIABLE","variableName":"vDuplicateEmailFound"}},{"uid":"7791ad8d-98cf-415f-ad14-7271b8b0badf","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vPriorMatchFound$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"T"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"9d99893c-0e7a-4af1-b606-ec189746a721","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"As the bot has found the email matching vTargetSubject, it sets a flag indicating so."}}]},{"uid":"ed6479aa-c4a8-4e4f-82b7-8fbab365685c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"T"}}],"returnTo":{"type":"VARIABLE","variableName":"vPriorMatchFound"}},{"uid":"0406fd20-aee1-4200-8094-224035cff711","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"1e8cad6f-c176-4cb8-bba5-11ef3d37ea6c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Unread email with matching subject found"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"20ea35e3-7bbe-4526-aaf7-3aeee6023d74","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Info"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"41e7b55c-4dc8-4d06-a241-ec0769adde07","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"483ed0de-6b63-468b-b4ba-dab99c272fae","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"57f81d3c-b5f3-402d-acbd-e331dcbd0ac0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]},{"uid":"7cae5e05-8ef9-473d-9b8c-d2cd6e83ee22","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"All attachments are automatically downloaded to the temporary directory for every iteration of the unread message loop.  This is a limitation of AA."}}]},{"uid":"58c4a3cb-6ca7-4525-ad7e-a7da19021213","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This loop scans the attachments for those matching the filename specified in the design documents."}}]},{"uid":"fc98ff66-58f9-4b9c-b7a1-d422b8c429b9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"d5bf10f1-d990-44df-8e9b-6922be3ffad1","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b90aecd3-8731-4e04-b6d1-ab9e248b5f39","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"47cd9502-f81f-45d7-922d-8f2fb8406c75","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vIsFilenameFound"}},{"uid":"dfe0ed61-2256-49a2-96af-6e4a18a25c6d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIsFilenameFound.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIsFilenameFound"}},{"uid":"61c5ceaf-6a9f-4b8e-bacf-839c6f62947d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"The following 'Find' string operation uses a regex to determine if the filename meets the format specificed in the design documents."}}]},{"uid":"edcc6b4f-2dff-467e-9e9a-be3abe15a99c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This cannot be loaded from the config. file as AA does not allow the '$' character to be in a variable.  A website like regex101.com can be used to parse and edit this regex statement."}}]},{"uid":"04dcc04b-1e43-4820-b20f-7fa674e777e8","commandName":"find","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"find","value":{"type":"STRING","string":"^[a-zA-Z0-9]{5}\\s?-\\s?Notice [0-9]+\\.xlsx?$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"integerReturnVariable"}},{"uid":"93a89c99-a5ce-4033-906f-59c2902792a4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$integerReturnVariable.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIsFilenameFound"}},{"uid":"5c761861-fa7d-4b7d-8faf-3c999b8edf21","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Files that match the target filename regex are coped to the working directory for further processing."}}]},{"uid":"03d989c0-31cd-4b15-92c6-cbf0fb50250f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"bb1c6b19-19d4-4259-9b27-df50bcc34788","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"$vInputPath$\\$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vTemporaryFolder$/$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"90caf9c1-11d9-4147-993b-8c27fcb7a608","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vTemporaryFolder$/$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4a7c0c7e-b822-401d-b659-53704fe3104c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vIsFilenameFound"}},{"uid":"9e0abcb9-0215-4e62-b2e4-83c906a5ab8a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIsFilenameFound.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vIsFilenameFound"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vIsFilenameFound$"}},{"name":"operator","value":{"type":"STRING","string":"GreaterThanOrEqualTo"}},{"name":"value","value":{"type":"STRING","string":"1"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}],"attributes":[{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vTemporaryFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]},{"uid":"8a05007a-3db6-4483-ac14-257d0ff4dbb1","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Any out of scope attachmets are copied to the working folder to be handled later."}}]},{"uid":"c5b1b695-8dd0-4cca-9bd4-de790347c960","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"$vWorkingFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vTemporaryFolder$/*.*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$Loop-Email-Response-1{emailSubject}$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vTargetEmailSubject$"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"fe596df4-bde2-4bf8-97b8-f892b1e5c2ab","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Leftover files are deleted from the temporary directory in preparation for the next iteration of the read email loop."}}]},{"uid":"665374c7-c964-451c-9619-bd78e5e0eeb3","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vTemporaryFolder$/*.*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"Loop-Email-Response-1"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession-1"}},{"name":"readStatus","value":{"type":"STRING","string":"UNREAD"}},{"name":"messageFormat","value":{"type":"STRING","string":"HTML"}},{"name":"folder","value":{"type":"STRING","string":"Inbox"}},{"name":"from","value":{"type":"STRING","string":""}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]},{"uid":"96a21f2a-0d98-4d44-a2a0-283418e22839","commandName":"closeEmail","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession-1"}}]},{"uid":"9ceb2fb7-ee05-42d5-a39e-305a71f95125","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"49c1edb5-2967-40cb-bb49-8752ef1f5742","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Connecting to IMAP server to retrieve mail"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"546bea6e-6a6c-48ae-bb1c-7fe51060135a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Completed"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"eb15d44d-1380-4fa0-bab9-a87c62ba0b7b","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"4e7cc1dd-1737-4b74-a6ef-17e4129c18d6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"94fcc023-88a2-4b17-b9e7-f65075355724","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}],"branches":[{"uid":"0df8d8a9-413a-458d-98b9-936bd640102a","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"73e6fe98-4bd9-4979-8612-3414b752ea2c","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"9129b17e-18b6-4d06-a904-c9f4e2696265","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"b5901198-9a4c-479f-a7d0-526039bf66e8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$System:AATaskName$,$Error-LineNumber.Number:toString$,\"$Error-Description$\",$m-string-1$,$m-string-2$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4cf46b06-5bfb-4926-b934-570943492a32","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorScreenshot$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"ef713603-dede-4250-b58a-cb2c9e03a955","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"2a975431-71ba-4e21-9401-c7962a72ab19","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"T"}}],"returnTo":{"type":"VARIABLE","variableName":"vIMAPconnectionFailed"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"18eb1bd2-5e3c-4d3f-a3ff-737080c9032d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"011a9641-757f-4921-9e7e-8bddbb5ba98d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If the flag indicating that the IMAP server cannot be reached is thrown, the bot sends a notification and prepares to shut down."}}]},{"uid":"43b89d1f-9e86-4ac1-8513-c826f4ec000e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"5f9af093-f7ad-4d12-9f09-ac7c90ba4f24","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"965f5e88-d699-421f-8745-ebb6156190bf","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIMAPfailedBody$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vIMAPfailedBody"}},{"uid":"a097326b-68b7-4094-ab2c-2213485c60b0","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vIMAPfailedBody$"}},{"name":"find","value":{"type":"STRING","string":" <Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vIMAPfailedBody"}},{"uid":"5f303512-abc2-432d-af4c-d8da4168ea69","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vProcessEmail$, $vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vIMAPfailedSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vIMAPfailedBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"03f3b29a-f990-40c9-861b-4dc6e66b7e8a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"f16442e6-26a8-4a90-b886-9241f3eef35b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Connecting to IMAP server to retrieve mail"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"17710f0c-c5ca-4b8c-b42a-a62428510fd3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"31c3eb71-6b16-4848-8beb-968d2855f064","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"b1b440a0-db67-4173-8137-e27f4aa34acc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5428ce0b-f142-4dd1-8a25-034e0100707f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}],"branches":[{"uid":"5187eb75-bb0d-4dad-bd10-5c41e68708e7","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"f8705dbe-f662-4852-bf5f-3769dbe39f2f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If a duplicate is found, the bot cleans up any files, sends a notification without processing, and prepares to shut down."}}]},{"uid":"90e99377-78a4-4398-9f3c-3ad7a09ce7b6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"6bcbc03b-aea8-4a80-8190-700d45335abf","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vInputPath$/*.*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"caedb9f3-f6c4-42ad-94f5-82ec2069d6bb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"fc17f9c2-eea6-4130-a18c-b229978fdca6","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDuplicateEmailExceptionBody$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDuplicateEmailExceptionBody"}},{"uid":"14961e53-6d3c-4269-a103-077a4c68a354","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDuplicateEmailExceptionBody$"}},{"name":"find","value":{"type":"STRING","string":" <Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vDuplicateEmailExceptionBody"}},{"uid":"ee3f34bd-1947-4c6c-8322-d4647a91bc45","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vProcessEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vDuplicateEmailExceptionSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vDuplicateEmailExceptionBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"a40a7c0a-fde0-4075-8e19-e26a34ecdf91","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"d99ea701-5c42-485a-8432-2dd4b7fbb5f7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Duplicate email found.  Please resolve manually."}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"0778b790-dbe2-4916-bad2-fc3fc6a0ad93","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"db88ea5e-364c-4ca8-8e14-9b203d6fc2eb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"0d7866b2-2a93-4674-b900-4e955ebc6f95","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b4418eed-32bf-45ac-9545-033db4b9da64","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDuplicateEmailFound$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"T"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"ed96dc19-e1ce-43ba-8200-c8b16a2a5df9","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"5c6bfeaa-a842-4216-acc4-fa1bc0c68fab","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If no email with a matching subject is found, a notification is sent and the bot will shut down."}}]},{"uid":"c8e28fc5-2f91-45b0-8fc7-d08afe58a1c5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"c5d13ae0-adcb-4151-904c-a082a826db21","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"21062ed2-ecec-46e4-8624-a73cfb3107e2","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNoEmaiBody$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vNoEmaiBody"}},{"uid":"56a9dd1b-e24d-4b7e-85be-a84c265ba758","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNoEmaiBody$"}},{"name":"find","value":{"type":"STRING","string":" <Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vNoEmaiBody"}},{"uid":"99784b13-9ecb-4a03-9d89-c8b40630da37","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vProcessEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vNoEmailSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vNoEmaiBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"fd26a14b-08ea-46d7-b895-83122e20465c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"6d71c327-a18e-4b13-871c-365c739de183","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"No email was found for the bot to process."}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"e3c6aab0-5800-4642-848d-042d96af9bb4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Info"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"da762a08-e9b7-4565-b861-a0fe6b740f7c","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"a50cd4c7-c3b7-420c-9ec9-cf2f682c50e6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5898f5a1-bb55-41c7-bf74-0b386645d75d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vPriorMatchFound$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"effe19e9-11cd-4a9f-85cd-f1c9d1995d29","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"281dedd6-15f4-4802-b137-1d4f950e41a6","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d95b86ff-eafd-4c8c-b44e-8f899ff48f14","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Any out of scope attachments that were saved are zipped up and sent with a notification."}}]},{"uid":"16242cbf-34cf-4d15-8313-6a528552316a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"72f2f679-f690-4898-804c-3e9779a91087","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Out of scope attachments were found.  Sending email notification."}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"5129e58a-1e97-4bbc-bd73-36d18f441d2b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Info"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"f75dd544-e8ea-45c6-806e-8f3da6b9b898","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"6ad075ba-56b0-4d64-b79d-30dbaa3805f0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"97606306-71cc-43e1-81bd-c596b2b5ed96","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]},{"uid":"4b36ece8-ca2c-4c62-a86d-8460d3107ba5","commandName":"zipFiles","packageName":"Folder","disabled":false,"attributes":[{"name":"sourcePath","value":{"type":"STRING","expression":"$vWorkingFolder$"}},{"name":"targetPath","value":{"type":"FILE","expression":"file://$vWorkingFolder$/$vInvalidAttachmentArchiveName$"}},{"name":"isUpdateNewer","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDeleteOriginalFiles","value":{"type":"BOOLEAN","boolean":false}},{"name":"compressionLevel","value":{"type":"STRING","string":"Normal"}},{"name":"filterType","value":{"type":"STRING","string":"StringValue"}},{"name":"filterExtensions","value":{"type":"STRING","string":"*.*"}}]},{"uid":"dfeecfaa-c8dd-495d-a7b4-aff8b1f3f6f8","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vInvalidAttachmentExceptionBody$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvalidAttachmentExceptionBody"}},{"uid":"6b0e15ce-fcca-4c9b-afa4-698ea0bd8220","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vInvalidAttachmentExceptionBody$"}},{"name":"find","value":{"type":"STRING","string":" <Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvalidAttachmentExceptionBody"}},{"uid":"d49ae430-463e-493a-820c-aaa8eee2b0e7","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vProcessEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vInvalidAttachmentExceptionSubject$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$vWorkingFolder$/$vInvalidAttachmentArchiveName$%3B"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vInvalidAttachmentExceptionBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vWorkingFolder$/*.*"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vIMAPconnectionFailed$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"T"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"42871c29-5394-4cc0-9a77-7cb299481d4d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Clean up any leftover files."}}]},{"uid":"c5094f85-f8b9-4c74-8583-d4ee074ac54b","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vTemporaryFolder$/*.*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"518ece78-2db2-4c9e-bce3-39e86080409e","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vWorkingFolder$/*.*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"bd5046ff-a109-4425-a8c4-5445bd0cb0b2","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"594060d9-3d3f-4378-8a86-8887c16051c2","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"c2fa5b11-869e-4e49-8aa5-f94888e9b750","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Retrieve attachments from IMAP server"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"b8997ac1-b988-44bc-a26f-062264f4668c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"7bad9e5f-69e9-4e05-a22a-df5f88b6ca38","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"aac8537a-bd18-4b74-afef-0c24ff41152d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8e1eef09-7bf3-41c3-a566-eaf4fdbce201","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}],"branches":[{"uid":"81f9c03d-49d1-4d48-a9a6-2094aa0e3507","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"24d16a6a-e37d-41e1-a843-5a6fc20f0eed","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log Begin*****"}}]},{"uid":"fc9556b8-e08b-4991-8bbd-f25cfd64e056","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Retrieve attachments from IMAP server"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"1563083d-b1f6-43e9-b4a6-8b6a3c3b2b67","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Completed"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"198576c9-4672-432a-81f3-c8876e4e1d2b","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"2980a3a9-66a4-44cf-8752-bef2fb6f4bf1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8b2f80ea-888c-4b99-a613-cbb13f0e867f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*****Log End*****"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vTaskStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"Failed"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}],"branches":[{"uid":"d82adb1e-6f80-465b-8bf1-e94814420896","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7608a59a-5596-4fad-88f5-ccdfc6c53b4d","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"42cf33ca-e3e6-48b7-8a35-cdd06590b510","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"82d14a2c-e8d3-4137-8d87-a05c7f5e30cc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$System:AATaskName$,$Error-LineNumber.Number:toString$,\"$Error-Description$\",$m-string-1$,$m-string-2$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0c3e9e78-9091-4d64-8550-094c178508a0","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorScreenshot$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"b73fcb7d-6548-4b61-bb0a-3a8c25568865","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"b0f50ec7-c9fd-4041-9a96-93fd55295a5d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"efe4fe1f-e8e3-48f9-a696-e2cf2a5ca1fb","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vProcessName$: Unexpected exception"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$vErrorScreenshot$%3BError%20Message.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"1125bca4-a294-4638-a3c2-5c33d3f7d09e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"5f94d15e-21a9-4946-91f3-267e3e152630","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f1778b1c-4345-4d8b-b01e-1bde6e445b2f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7cf2694c-a1a8-4388-85da-3f45f5477571","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}]}]}],"variables":[{"name":"vTargetEmailSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAuditLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInputPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vProcessEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDuplicateEmailExceptionBody","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDuplicateEmailExceptionSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vWorkingFolder","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTemporaryFolder","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPriorMatchFound","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIsFilenameFound","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvalidAttachmentExceptionSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvalidAttachmentExceptionBody","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvalidAttachmentArchiveName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogMessage","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIMAPserver","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIMAPconnectionFailed","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDuplicateEmailFound","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorScreenshot","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vProcessName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRPAsupportEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vEmailFrom","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIMAPfailedSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIMAPfailedBody","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNoEmailSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNoEmaiBody","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Email-Response","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false,"defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"emailCc","value":{"type":"STRING","string":""}},{"key":"emailReceivedDate","value":{"type":"STRING","string":""}},{"key":"emailMessage","value":{"type":"STRING","string":""}},{"key":"emailFrom","value":{"type":"STRING","string":""}},{"key":"emailTo","value":{"type":"STRING","string":""}},{"key":"emailReceivedTime","value":{"type":"STRING","string":""}},{"key":"emailSubject","value":{"type":"STRING","string":""}}]}},{"name":"Loop-Email-Response-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-return-date","description":"","type":"DATETIME","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"integerReturnVariable","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"vDevStageControlRoomURL","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210504-152757"},{"name":"Boolean","version":"2.1.0-20210504-152757"},{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"Datetime","version":"2.2.0-20210504-152815"},{"name":"Datetime","version":"2.2.0-20210504-152815"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"LogToFile","version":"3.0.0-20210504-152939"},{"name":"LogToFile","version":"3.0.0-20210504-152939"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"Screen","version":"2.2.0-20210504-153440"},{"name":"Screen","version":"2.2.0-20210504-153440"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"TaskBot","version":"2.0.1-20210503-140009"},{"name":"TaskBot","version":"2.0.1-20210503-140009"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}