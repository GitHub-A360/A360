{"triggers":[],"nodes":[{"uid":"b1eb6721-a87f-495f-88fe-0dbd3da372bc","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"027192b9-a3b3-4195-ba4f-535a06802841","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Name: 1.2.0 PI Creation_AcquireInputs"}}]},{"uid":"8a495684-4b1b-4ccd-b92a-d4e6a9f5a6b8","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task description: This task creates the appropriate folder structures and log files used within the process"}}]},{"uid":"944b4b40-6d82-4a67-b764-720d89f8ac58","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Dependecies: 1.0.0 Cash Balance Report_MasterTask.atmx"}}]},{"uid":"74475722-b1f9-4b6d-b478-2ea91add3650","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Modified By:"}}]},{"uid":"a4c76e6f-65b2-40a4-ae93-9698694f06a4","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Date Modified: \n"}}]},{"uid":"c721d35f-6f63-46ae-abaa-a16c404e13da","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the commands to handle errors."}}]},{"uid":"d1967ab1-c8f0-4ad2-8806-c31abd02f669","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"ffead4a1-ea3b-4c86-85ed-eef63597d938","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"1eb77003-27ed-49ce-a5ae-250065a6b5a3","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"3a554875-368d-402b-ac18-8c531e88ecd7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ed2b8b21-ecbc-401b-b0ea-e8199ea303ea","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1a674a4d-1925-4cff-b40d-db92ce046489","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/SBA/Accounting/RPA002-PICreationfromBackstop/1.1.0%20Pi%20Creation%20From%20Backstop%20-%20Read%20Config%20File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"vReadyForBotFolder","value":{"type":"VARIABLE","variableName":"vReadyForBotFolder"}},{"key":"vCompletedByBot","value":{"type":"VARIABLE","variableName":"vCompletedByBot"}},{"key":"vExceptionsFromBot","value":{"type":"VARIABLE","variableName":"vExceptionsFromBot"}},{"key":"vBackstopHome","value":{"type":"VARIABLE","variableName":"vBackstopHome"}},{"key":"vRPAFolderPath","value":{"type":"VARIABLE","variableName":"vRPAFolderPath"}},{"key":"vCurrentEnvironment","value":{"type":"VARIABLE","variableName":"vCurrentEnvironment"}},{"key":"vProcessName","value":{"type":"VARIABLE","variableName":"vProcessName"}},{"key":"vEmailFrom","value":{"type":"VARIABLE","variableName":"vEmailFrom"}},{"key":"vEmailToBusiness","value":{"type":"VARIABLE","variableName":"vEmailToBusiness"}},{"key":"vEmailToRPASupport","value":{"type":"VARIABLE","variableName":"vEmailToRPASupport"}},{"key":"vEmailExceptionBody_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopLoginFailure"}},{"key":"vEmailExceptionSubject_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopLoginFailure"}},{"key":"vEmailExceptionSubject_BackstopFiltersInvalid","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopFiltersInvalid"}},{"key":"vEmailExceptionBody_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"key":"vEmailExceptionSubject_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoResultsReturned"}},{"key":"vEmailExceptionBody_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopMissingExcelDownload"}},{"key":"vEmailExceptionSubject_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopMissingExcelDownload"}},{"key":"vErrorFlag","value":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"key":"vErrorScreenshotsPath","value":{"type":"VARIABLE","variableName":"vErrorScreenshotsPath"}},{"key":"M-CPU-Usage-StringVal","value":{"type":"VARIABLE","variableName":"M-CPU-Usage-StringVal"}},{"key":"my-list-variable","value":{"type":"VARIABLE","variableName":"my-list-variable"}},{"key":"vErrorLogPath","value":{"type":"VARIABLE","variableName":"vErrorLogPath"}},{"key":"vEmailExceptionBody_MissingDetailTab","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_MissingDetailTab"}},{"key":"vEmailExceptionBody_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionSubject_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionBody_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_DateMismatch"}},{"key":"vEmailExceptionSubject_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_DateMismatch"}},{"key":"sBackstop_Username","value":{"type":"VARIABLE","variableName":"sBackstop_Username"}},{"key":"sBackstop_Token","value":{"type":"VARIABLE","variableName":"sBackstop_Token"}},{"key":"sBackstop_Url","value":{"type":"VARIABLE","variableName":"sBackstop_Url"}}]}},{"uid":"efa5b587-c151-4c1a-a1f6-79c9911c32a0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"\\\\sbafshare\\rpa\\dev\\RPA002_Standalone\\"}}],"returnTo":{"type":"VARIABLE","variableName":"vTempPath"}},{"uid":"1341f101-e332-477f-a099-2b8641c38f71","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTempPath$\\Output"}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputPath"}},{"uid":"09d7f94f-8544-4375-b41c-469564dede7f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"10579"}}],"returnTo":{"type":"VARIABLE","variableName":"vBackstopAccountId"}},{"uid":"d1ef5aaa-ec38-42cc-9462-23e82509cac9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"76"}}],"returnTo":{"type":"VARIABLE","variableName":"vBackstopNoticeId"}},{"uid":"59af86b4-e783-4136-8244-890ad7a2c362","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTempPath$\\Logs\\Audit.log"}}],"returnTo":{"type":"VARIABLE","variableName":"vAuditLog"}},{"uid":"1b929f4d-1b16-4871-8fba-c554444ee4a1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTempPath$\\Logs\\Error.log"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLog"}},{"uid":"e7f74fda-4756-4f4e-957d-ed46aab8e5a5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"13ab4437-f70e-4371-bd41-b48cf3944770","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"777e675f-a02c-4b1b-8a42-42d2d0f91e43","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"61f0e939-8741-4439-9fb3-74baf8c97715","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"eb20ca2d-463c-4b42-8da5-5e56005294b9","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ecdb5aa3-e76f-4338-b861-007ecd4ff9d0","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$bIsStandalone$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"b9f5cfda-9adc-49ff-adbb-6952e7adfd1d","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"2"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"8a0258b6-5079-4f6b-9967-cad5e99d8da2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vAuditLog$"}}],"returnTo":{"type":"VARIABLE","variableName":"sAuditLogPath"}},{"uid":"0d05f046-26c3-47e8-bed7-6f58cfa7ae28","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vErrorLog$"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLogPath"}},{"uid":"db343491-b029-43a6-8eca-63c89e36fbf0","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"1aaeb2e8-d193-48e3-892c-fac98f781cbf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Acquiring Files From Backstop - STARTED"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"d0b17655-4456-41aa-a16f-90946cc37780","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"In-Progress"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"2fa1eed8-c928-42e9-af78-514685411227","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"500"}},{"name":"timeUnit","value":{"type":"STRING","string":"MILLISECONDS"}}]},{"uid":"99044913-9543-4038-9926-1d63e7660a82","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b4d25692-9022-4e36-a852-22366181b287","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Getting TRSS File"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"4654b277-7333-48be-b63d-1562a77d1e05","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"# -*- coding: utf-8 -*-\nimport requests\nimport json\nimport pandas as pd\nimport re\n\ndef BackstopJsonToExcelTRSS (Largs):\n    jObj = json.loads(Largs[0])\n    rows = jObj[\"data\"][\"attributes\"][\"result\"][\"values\"]\n    df = pd.DataFrame(rows)\n    otherId = df[\"Other ID\"][0]\n    df[\"Other ID\"] = \"\"  \n    rowCount = df[\"Amount (Distributions Negative)\"].count()\n    newRow = pd.DataFrame({\n        'Other ID':\totherId,\n        'Effective Date': None,\n        'Mgmt Fee Period Begin Date': None,\n        'Mgmt Fee Period End Date':None,\n        'Description': None,\n        'Transaction Type': None,\n        'Amount (Distributions Negative)': None,\n        'Notice Other ID': None,\n        'Carried Interest': None },\n        index=[0])\n    df = pd.concat([newRow, df]).reset_index(drop = True)\n    rowCount += 1\n\n    df[\"Amount (Distributions Negative)\"] = df[\"Amount (Distributions Negative)\"].str.replace('\\((.*)\\)', '-\\\\1')\n    df[\"Amount (Distributions Negative)\"] = df[\"Amount (Distributions Negative)\"].str.replace('[^.0-9\\-]', '')\n    df[\"Amount (Distributions Negative)\"] = pd.to_numeric(df[\"Amount (Distributions Negative)\"],errors='coerce')          \n    df = df.append(df.sum(numeric_only=True),ignore_index=True) \n    rowCount += 1\n    otherId = otherId + \" Total\"\n    df[\"Other ID\"][rowCount-1] = otherId\n    #df.to_excel(Largs[1], index=False)\n\n    #ExcelFormatting As Needed\n    writer = pd.ExcelWriter(Largs[1],\n                        engine='xlsxwriter',\n                        date_format='m/d/yyyy')\n    df.to_excel(writer,sheet_name='TRSS',index=False)\n    workbook  = writer.book    \n    worksheet = writer.sheets['TRSS']\n    for idx, col in enumerate(df):  # loop through all columns\n        series = df[col]      \n        max_len = max((\n            series.astype(str).map(len).max(),  # len of largest item\n            len(str(series.name))  # len of column name/header\n            )) + 1  # adding a little extra space\n        worksheet.set_column(idx, idx, max_len)  # set column width\n    # Close the Pandas Excel writer and output the Excel file.\n    writer.save()\n\ndef BackstopJsonToExcelPI (Largs):\n    jObj = json.loads(Largs[0])\n    rows = jObj[\"data\"][\"attributes\"][\"result\"][\"values\"]\n\n    df = pd.DataFrame(rows)\n    bnym = df[\"BNYM ID\"][0] + \" Total\"\n    notice = df[\"Notice Other ID\"][0]\n    df[\"BNYM ID\"] = \"\"\n    df[\"Notice Other ID\"] = \"\"\n    df = df.drop(columns=['STAR Account #','Initial Value (Redemptions Negative)'])\n    for i in range(df[\"Amount\"].count()):\n        if (\"77260\" not in df[\"Transaction Type\"][i]):\n            df[\"Mgr Fee Ticker\"][i] = \"\"\n        else:\n            df[\"STAR Ticker\"][i] = \"\"\n    df.loc[df.shape[0]] = [None, None, None,None, None, None,None, None, None,None,None]    \n    df[\"Amount\"] = df[\"Amount\"].str.replace('\\((.*)\\)', '-\\\\1')\n    df[\"Amount\"] = df[\"Amount\"].str.replace('[^.0-9\\-]', '')\n    df[\"Amount\"] = pd.to_numeric(df[\"Amount\"],errors='coerce')        \n    df = df.append(df.sum(numeric_only=True),ignore_index=True)\n    rowCount = df[\"Amount\"].count()\n    df[\"Notice Other ID\"][rowCount-1] = notice\n    df[\"BNYM ID\"][rowCount] = bnym\n    #df.to_excel(Largs[1], index=False)\n    \n    #ExcelFormatting As Needed\n    writer = pd.ExcelWriter(Largs[1],\n                        engine='xlsxwriter',\n                        date_format='m/d/yyyy')\n    \n    df.to_excel(writer,sheet_name='PI',index=False)\n    workbook  = writer.book    \n    worksheet = writer.sheets['PI']\n    header_format = workbook.add_format({'bold': True, 'text_wrap': True, 'align': 'center'})\n    for idx, col in enumerate(df):  # loop through all columns\n        series = df[col]\n        max_len = max((\n            series.astype(str).map(len).max(),  # len of largest item\n            len(str(series.name))  # len of column name/header\n            )) + 1  # adding a little extra space\n        worksheet.set_column(idx, idx, max_len)  # set column width\n    worksheet.set_row(0,38.25,header_format)\n\n    # Close the Pandas Excel writer and output the Excel file.\n    writer.save()\n"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"169ba8dc-ffa5-495e-9096-e3197b3c9e87","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get the last day of the previous month"}}]},{"uid":"20f82509-21ef-47ea-ba65-91ebb92cdd16","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","expression":"$System:Year.Number:toString$-$System:Month.Number:toString$-01"}},{"name":"formatType","value":{"type":"STRING","string":"custom"}},{"name":"customFormat","value":{"type":"STRING","string":"yyyy-M-dd"}}],"returnTo":{"type":"VARIABLE","variableName":"dtLastMonthLastDay"}},{"uid":"191c5595-33ec-4431-96a2-567bb4ccc3da","commandName":"subtract","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtLastMonthLastDay"}},{"name":"val","value":{"type":"NUMBER","number":"1"}},{"name":"unit","value":{"type":"STRING","string":"DAYS"}}],"returnTo":{"type":"VARIABLE","variableName":"dtLastMonthLastDay"}},{"uid":"9cee9abb-ca23-4a1f-8cc1-45ace95a6a16","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtLastMonthLastDay"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"yyyy-MM-dd"}}],"returnTo":{"type":"VARIABLE","variableName":"sPrevMonthLastDay"}},{"uid":"eab346de-c5b5-401c-b9b4-90aa60040b95","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Load the appropriate JSON"}}]},{"uid":"a57cd7b2-430f-44bd-a9ee-e1750bccb497","commandName":"ImportStringFromTextFile","packageName":"String","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Docs/SBA/Accounting/RPA002-PICreationfromBackstop/TRSS_Base.txt"}},{"name":"key","value":{"type":"STRING","string":"myVar"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopTRSS"}},{"uid":"1bf74d4c-bd88-4396-958b-3867b84622f5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Replace the variables needed in the JSON"}}]},{"uid":"d6396e39-b0bc-4085-a769-ff90d01b563c","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopTRSS$"}},{"name":"find","value":{"type":"STRING","string":"_as_of_date_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sPrevMonthLastDay$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopTRSS"}},{"uid":"54b25867-abd5-46bc-a836-41392811fcf5","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopTRSS$"}},{"name":"find","value":{"type":"STRING","string":"_account_id_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vBackstopAccountId$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopTRSS"}},{"uid":"a7ba0b87-93f0-4a3b-95ba-830c82c2b3c2","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopTRSS$"}},{"name":"find","value":{"type":"STRING","string":"_notice_id_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vBackstopNoticeId$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopTRSS"}},{"uid":"2e3b9d01-9a1c-4f87-8eb2-349467176f39","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If an output file is needed, define the full path"}}]},{"uid":"7f376b46-91ab-481b-b09d-0fe631b82494","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sBackstopJSON","value":{"type":"STRING","expression":"$fBackstopTRSS$"}},{"key":"bTaskStatus","value":{"type":"BOOLEAN","boolean":true}},{"key":"sOutputFullFilename","value":{"type":"STRING","expression":"$sOutputFilename$"}},{"key":"bOutputFile","value":{"type":"BOOLEAN","boolean":false}},{"key":"sAuditLogPath","value":{"type":"STRING","expression":"$sAuditLogPath$"}},{"key":"sErrorLogPath","value":{"type":"STRING","expression":"$sErrorLogPath$"}},{"key":"bIsStandalone","value":{"type":"BOOLEAN","boolean":false}},{"key":"my-list-variable","value":{"type":"LIST","expression":"$my-list-variable$"}},{"key":"vBackstop_RetryAttempts","value":{"type":"STRING","expression":"$vBackstop_RetryAttempts$"}},{"key":"vEmailExceptionBody_BackstopMissingExcelDownload","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopMissingExcelDownload$"}},{"key":"vProcessName","value":{"type":"STRING","expression":"$vProcessName$"}},{"key":"vEmailExceptionSubject_BackstopNoResultsReturned","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopNoResultsReturned$"}},{"key":"vEmailFrom","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"key":"vEmailToBusiness","value":{"type":"STRING","expression":"$vEmailToBusiness$"}},{"key":"vEmailExceptionBody_BackstopNoResultsReturned","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"key":"vErrorScreenshotsPath","value":{"type":"STRING","expression":"$vErrorScreenshotsPath$"}},{"key":"vEmailExceptionSubject_BackstopFiltersInvalid","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopFiltersInvalid$"}},{"key":"vBackstopHome","value":{"type":"STRING","expression":"$vBackstopHome$"}},{"key":"vEmailExceptionSubject_BackstopMissingExcelDownload","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopMissingExcelDownload$"}},{"key":"vErrorFlag","value":{"type":"STRING","expression":"$vErrorFlag$"}},{"key":"vEmailToRPASupport","value":{"type":"STRING","expression":"$vEmailToRPASupport$"}},{"key":"vEmailExceptionBody_BackstopLoginFailure","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopLoginFailure$"}},{"key":"vReadyForBotFolder","value":{"type":"STRING","expression":"$vReadyForBotFolder$"}},{"key":"vExceptionsFromBot","value":{"type":"STRING","expression":"$vExceptionsFromBot$"}},{"key":"vEmailExceptionSubject_BackstopLoginFailure","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopLoginFailure$"}},{"key":"vCompletedByBot","value":{"type":"STRING","expression":"$vCompletedByBot$"}},{"key":"vErrorLogPath","value":{"type":"STRING","expression":"$vErrorLogPath$"}},{"key":"vBackstop_DETAIL_URL","value":{"type":"STRING","expression":"$vBackstop_DETAIL_URL$"}},{"key":"vEmailExceptionBody_MissingDetailTab","value":{"type":"STRING","expression":"$vEmailExceptionBody_MissingDetailTab$"}},{"key":"vEmailExceptionBody_BackstopNoDetailResultsReturned","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoDetailResultsReturned$"}},{"key":"vEmailExceptionSubject_BackstopNoDetailResultsReturned","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopNoDetailResultsReturned$"}},{"key":"vEmailExceptionBody_DateMismatch","value":{"type":"STRING","expression":"$vEmailExceptionBody_DateMismatch$"}},{"key":"vEmailExceptionSubject_DateMismatch","value":{"type":"STRING","expression":"$vEmailExceptionSubject_DateMismatch$"}},{"key":"M-CPU-Usage-StringVal","value":{"type":"STRING","expression":"$M-CPU-Usage-StringVal$"}},{"key":"sBackstop_Username","value":{"type":"STRING","expression":"$sBackstop_Username$"}},{"key":"sBackstop_Token","value":{"type":"STRING","expression":"$sBackstop_Token$"}},{"key":"sBackstop_Url","value":{"type":"STRING","expression":"$sBackstop_Url$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/SBA/Shared/BackstopAPIReports"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"sBackstopResponse","value":{"type":"VARIABLE","variableName":"sBackstopResponse"}},{"key":"sAuditLogPath","value":{"type":"VARIABLE","variableName":"sAuditLogPath"}},{"key":"sErrorLogPath","value":{"type":"VARIABLE","variableName":"sErrorLogPath"}},{"key":"sBackstopJSON","value":{"type":"VARIABLE","variableName":"sBackstopJSON"}},{"key":"bTaskStatus","value":{"type":"VARIABLE","variableName":"bTaskStatus"}},{"key":"sOutputFullFilename","value":{"type":"VARIABLE","variableName":"sOutputFullFilename"}},{"key":"bOutputFile","value":{"type":"VARIABLE","variableName":"bOutputFile"}},{"key":"bIsStandalone","value":{"type":"VARIABLE","variableName":"bIsStandalone"}},{"key":"my-list-variable","value":{"type":"VARIABLE","variableName":"my-list-variable"}},{"key":"vBackstop_RetryAttempts","value":{"type":"VARIABLE","variableName":"vBackstop_RetryAttempts"}},{"key":"vEmailExceptionBody_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopMissingExcelDownload"}},{"key":"vProcessName","value":{"type":"VARIABLE","variableName":"vProcessName"}},{"key":"vEmailExceptionSubject_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoResultsReturned"}},{"key":"vEmailFrom","value":{"type":"VARIABLE","variableName":"vEmailFrom"}},{"key":"vEmailToBusiness","value":{"type":"VARIABLE","variableName":"vEmailToBusiness"}},{"key":"vEmailExceptionBody_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"key":"vErrorScreenshotsPath","value":{"type":"VARIABLE","variableName":"vErrorScreenshotsPath"}},{"key":"vEmailExceptionSubject_BackstopFiltersInvalid","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopFiltersInvalid"}},{"key":"vBackstopHome","value":{"type":"VARIABLE","variableName":"vBackstopHome"}},{"key":"vEmailExceptionSubject_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopMissingExcelDownload"}},{"key":"vErrorFlag","value":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"key":"vEmailToRPASupport","value":{"type":"VARIABLE","variableName":"vEmailToRPASupport"}},{"key":"vEmailExceptionBody_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopLoginFailure"}},{"key":"vReadyForBotFolder","value":{"type":"VARIABLE","variableName":"vReadyForBotFolder"}},{"key":"vExceptionsFromBot","value":{"type":"VARIABLE","variableName":"vExceptionsFromBot"}},{"key":"vEmailExceptionSubject_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopLoginFailure"}},{"key":"vCompletedByBot","value":{"type":"VARIABLE","variableName":"vCompletedByBot"}},{"key":"vErrorLogPath","value":{"type":"VARIABLE","variableName":"vErrorLogPath"}},{"key":"vEmailExceptionBody_MissingDetailTab","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_MissingDetailTab"}},{"key":"vEmailExceptionBody_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionSubject_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionBody_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_DateMismatch"}},{"key":"vEmailExceptionSubject_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_DateMismatch"}},{"key":"M-CPU-Usage-StringVal","value":{"type":"VARIABLE","variableName":"M-CPU-Usage-StringVal"}},{"key":"sBackstop_Username","value":{"type":"VARIABLE","variableName":"sBackstop_Username"}},{"key":"sBackstop_Token","value":{"type":"VARIABLE","variableName":"sBackstop_Token"}}]}},{"uid":"1a9ec2da-e115-4f55-89c0-deffd4cf9119","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"75d0ef05-73de-437b-b63a-1041819ee14b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Getting PI File"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"3c686e0f-5cf2-48af-9adf-53cee68fa03d","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"500"}},{"name":"timeUnit","value":{"type":"STRING","string":"MILLISECONDS"}}]},{"uid":"18da263f-34d2-4b04-85df-92aaa7dd2c7f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f71a8564-a59d-49fb-b47f-87790bd0419c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"157f9948-3fb4-4a99-b7d7-25aa7dc60637","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"798d6a29-ce39-4ba2-b7a9-2906d6b6cb71","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"No results found for $vBackstopAccountId$-$vBackstopNoticeId$ - PDF Name report, raise exception, move file and move to next file\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f26a50c1-fccc-4de4-b935-8896639c12b4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"uid":"fa8219dd-64b6-49f8-a8f7-449aa3771991","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<input filename>"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sBackstopFilename$"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"c636f595-41b4-4c48-bc6f-e5057da8e402","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<network_directory>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vExceptionsFromBot$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"d97fafc1-4631-42d9-8449-1c0c6f472a36","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"5dc9507c-d696-4d17-ba0c-c030aaf3be0a","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"ca33af00-8ead-461c-b4fe-39eae2c3f3c8","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_PI_NoResults_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"cbb468ad-758b-4518-9c3c-1c6914cd7dd7","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vEmailToBusiness$"}},{"name":"cc","value":{"type":"STRING","expression":"$vEmailToRPASupport$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopNoResultsReturned$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_NoResults_InvalidFilter_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png%3B"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"04951274-aaf7-401a-a4f8-3830393691dd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Data was not found on $vBackstop_PageFlag$ Page for $vBackstopAccountId$-$vBackstopNoticeId$"}}],"returnTo":{"type":"VARIABLE","variableName":"vExceptionMessage"}},{"uid":"756d655d-2440-4ce9-a598-82f38c37d4f3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,NA,$vExceptionMessage$,$m-string-1$,$m-string-2$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9dc7e970-8180-4283-92d6-1237dd2b286e","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFilename$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vExceptionsFromBot$\\$sBackstopFilename$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a3123752-1822-435d-ba8e-e4f707a09f8f","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFilename$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1d7da4c1-902e-4239-a6ad-50c89c3a5011","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"$sBackstopFilename$ - PDF Name Moved to exceptions folder\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"c4e8a6e6-7492-45dd-95cd-9ee9cdb8ec4e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Bot Error"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"html"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"74983b6f-fe23-42cc-a8ed-38f3c47293b9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vOutputPath$\\TRSS_$vBackstopAccountId$_$vBackstopNoticeId$.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"sOutputFilename"}},{"uid":"e5b16860-2bbc-4cb2-ad22-ea96f74dca3b","commandName":"clear","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}}]},{"uid":"0701b4d0-60bf-4449-a781-839c60faf8e3","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sBackstopResponse"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"b5ac5475-5203-40a8-a5f2-b3d718f3d557","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sOutputFilename"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"a8768ef5-05ae-42d6-8781-06ec23b494af","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"523439b6-f03d-4709-890d-724cff07aa68","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Converting to PI XLSX "}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"caec0338-080a-4f74-a45f-e0ae1f058881","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9e3326f3-c08d-429b-b8a5-5aae89e122c3","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"BackstopJsonToExcelTRSS"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"lPythonList"}}]},{"uid":"4c5bba12-bf6c-4b8c-b28e-3cd2193c1afb","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"597abc24-ee4e-49c0-a53d-3aa98f7b4b9c","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"e03625ec-5126-4aca-96f0-3bac4ea020d5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"No TRSS File Created for $vBackstopAccountId$-$vBackstopNoticeId$ - PDF Name report, raise exception, move file and move to next file\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"845da890-39ff-43fc-ab23-aea9594c8e04","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"uid":"3a87a221-ca5e-430f-9656-ae2b0fbe1751","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<input filename>"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sBackstopFilename$"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"aca14e9c-066a-4fac-b2c8-131464e8a0b9","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<network_directory>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vExceptionsFromBot$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"e0e0e1d0-eb9f-4e40-a4d9-120269c02aa2","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"1519ac44-1ed4-4fbc-aca0-e2e6a6d74e53","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"a8313536-2796-4fab-9407-22c7bc5c78a9","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_PI_NoResults_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"d9c76095-beaf-4902-917e-7ad69db4ce14","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vEmailToBusiness$"}},{"name":"cc","value":{"type":"STRING","expression":"$vEmailToRPASupport$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopNoResultsReturned$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_NoResults_InvalidFilter_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png%3B"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"c5f4eb20-ae37-45df-9773-5418ba9bb692","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"TRSS File Not Created  for $vBackstopAccountId$-$vBackstopNoticeId$"}}],"returnTo":{"type":"VARIABLE","variableName":"vExceptionMessage"}},{"uid":"3814154f-5a1f-430b-92de-c6304491e52a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,NA,$vExceptionMessage$,$m-string-1$,$m-string-2$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"73de06bc-1b1b-484c-af63-9573906a682a","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFilename$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vExceptionsFromBot$\\$sBackstopFilename$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1d7b9fac-ee37-4ebb-bb01-7a4d71b32fab","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFilename$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"656e2974-a81b-47e7-bad2-5390f9b3c77e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"$sBackstopFilename$ - PDF Name Moved to exceptions folder\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"78e15a75-629a-4bbc-8cf5-0913ce306c77","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sOutputFilename$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"5"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"88b4976f-0599-4cb7-a6f3-b0c1da9b21fb","commandName":"ImportStringFromTextFile","packageName":"String","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Docs/SBA/Accounting/RPA002-PICreationfromBackstop/PI_Base.txt"}},{"name":"key","value":{"type":"STRING","string":"myVar"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopPI"}},{"uid":"523cce5b-0634-4399-a52d-27bc982f6ea9","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopPI$"}},{"name":"find","value":{"type":"STRING","string":"_as_of_date_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sPrevMonthLastDay$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopPI"}},{"uid":"24f8bc70-9c96-4b50-93bb-ac8da5d42820","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopPI$"}},{"name":"find","value":{"type":"STRING","string":"_account_id_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vBackstopAccountId$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopPI"}},{"uid":"2897ac6d-b22c-4cee-bd8d-9924e1dcba17","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$fBackstopPI$"}},{"name":"find","value":{"type":"STRING","string":"_notice_id_"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vBackstopNoticeId$"}}],"returnTo":{"type":"VARIABLE","variableName":"fBackstopPI"}},{"uid":"6ac89afa-1363-4694-9e6d-3b093e77e5bd","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"5388153a-e2c8-448a-a191-1a23a2bd7c72","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Getting TRSS File"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"5e5f2e7c-1228-41ff-8b41-04acf6c4ed97","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9fab62c4-3660-4083-9858-613eaeff34b1","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sBackstopJSON","value":{"type":"STRING","expression":"$fBackstopPI$"}},{"key":"bTaskStatus","value":{"type":"BOOLEAN","boolean":true}},{"key":"sOutputFullFilename","value":{"type":"STRING","expression":"$sOutputFilename$"}},{"key":"bOutputFile","value":{"type":"BOOLEAN","boolean":false}},{"key":"sAuditLogPath","value":{"type":"STRING","expression":"$sAuditLogPath$"}},{"key":"sErrorLogPath","value":{"type":"STRING","expression":"$sErrorLogPath$"}},{"key":"bIsStandalone","value":{"type":"BOOLEAN","boolean":false}},{"key":"sBackstop_Username","value":{"type":"STRING","expression":"$sBackstop_Username$"}},{"key":"sBackstop_Token","value":{"type":"STRING","expression":"$sBackstop_Token$"}},{"key":"sBackstop_Url","value":{"type":"STRING","expression":"$sBackstop_Url$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/SBA/Shared/BackstopAPIReports"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"sBackstopResponse","value":{"type":"VARIABLE","variableName":"sBackstopResponse"}},{"key":"sAuditLogPath","value":{"type":"VARIABLE","variableName":"sAuditLogPath"}},{"key":"sErrorLogPath","value":{"type":"VARIABLE","variableName":"sErrorLogPath"}},{"key":"sBackstopJSON","value":{"type":"VARIABLE","variableName":"sBackstopJSON"}},{"key":"bTaskStatus","value":{"type":"VARIABLE","variableName":"bTaskStatus"}},{"key":"sOutputFullFilename","value":{"type":"VARIABLE","variableName":"sOutputFullFilename"}},{"key":"bOutputFile","value":{"type":"VARIABLE","variableName":"bOutputFile"}},{"key":"bIsStandalone","value":{"type":"VARIABLE","variableName":"bIsStandalone"}},{"key":"my-list-variable","value":{"type":"VARIABLE","variableName":"my-list-variable"}},{"key":"vBackstop_RetryAttempts","value":{"type":"VARIABLE","variableName":"vBackstop_RetryAttempts"}},{"key":"vEmailExceptionBody_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopMissingExcelDownload"}},{"key":"vProcessName","value":{"type":"VARIABLE","variableName":"vProcessName"}},{"key":"vEmailExceptionSubject_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoResultsReturned"}},{"key":"vEmailFrom","value":{"type":"VARIABLE","variableName":"vEmailFrom"}},{"key":"vEmailToBusiness","value":{"type":"VARIABLE","variableName":"vEmailToBusiness"}},{"key":"vEmailExceptionBody_BackstopNoResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"key":"vErrorScreenshotsPath","value":{"type":"VARIABLE","variableName":"vErrorScreenshotsPath"}},{"key":"vEmailExceptionSubject_BackstopFiltersInvalid","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopFiltersInvalid"}},{"key":"vBackstopHome","value":{"type":"VARIABLE","variableName":"vBackstopHome"}},{"key":"vEmailExceptionSubject_BackstopMissingExcelDownload","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopMissingExcelDownload"}},{"key":"vErrorFlag","value":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"key":"vEmailToRPASupport","value":{"type":"VARIABLE","variableName":"vEmailToRPASupport"}},{"key":"vEmailExceptionBody_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopLoginFailure"}},{"key":"vReadyForBotFolder","value":{"type":"VARIABLE","variableName":"vReadyForBotFolder"}},{"key":"vExceptionsFromBot","value":{"type":"VARIABLE","variableName":"vExceptionsFromBot"}},{"key":"vEmailExceptionSubject_BackstopLoginFailure","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopLoginFailure"}},{"key":"vCompletedByBot","value":{"type":"VARIABLE","variableName":"vCompletedByBot"}},{"key":"vErrorLogPath","value":{"type":"VARIABLE","variableName":"vErrorLogPath"}},{"key":"vEmailExceptionBody_MissingDetailTab","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_MissingDetailTab"}},{"key":"vEmailExceptionBody_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionSubject_BackstopNoDetailResultsReturned","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_BackstopNoDetailResultsReturned"}},{"key":"vEmailExceptionBody_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionBody_DateMismatch"}},{"key":"vEmailExceptionSubject_DateMismatch","value":{"type":"VARIABLE","variableName":"vEmailExceptionSubject_DateMismatch"}},{"key":"M-CPU-Usage-StringVal","value":{"type":"VARIABLE","variableName":"M-CPU-Usage-StringVal"}},{"key":"sBackstop_Username","value":{"type":"VARIABLE","variableName":"sBackstop_Username"}},{"key":"sBackstop_Token","value":{"type":"VARIABLE","variableName":"sBackstop_Token"}}]}},{"uid":"250c0128-985a-4b12-9568-d068192b4fc1","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"193b0fd1-a626-45f8-81dc-0c7f6f9717c6","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"e54c3f1f-bb05-4734-b97a-84476188d209","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"No results found for $sBackstopFileName$ - PDF Name report, raise exception, move file and move to next PDF\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8c9a4d04-df05-4446-97cd-29262823d72b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorFlag"}},{"uid":"ae294abb-2025-4b63-b7ae-03df20d3efe8","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<input filename>"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sBackstopFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"4ed53dab-e331-481a-9cb3-a2704780d5cd","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<network_directory>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vExceptionsFromBot$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"f4e3d908-b51b-43d1-929b-8f434609a69c","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Date / timestamp>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-date-string$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"0d18ca47-2495-4a4a-9c3b-93c1606fd235","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"find","value":{"type":"STRING","string":"<Username>"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$m-string-1$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmailExceptionBody_BackstopNoResultsReturned"}},{"uid":"b4998d40-dd49-4204-a160-fb25ae5e1ab2","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_PI_NoResults_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"26e2231d-6bce-49c1-bc66-24321f27b232","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vEmailToBusiness$"}},{"name":"cc","value":{"type":"STRING","expression":"$vEmailToRPASupport$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vEmailExceptionSubject_BackstopNoResultsReturned$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$vErrorScreenshotsPath$/ErrorScreenshot_Backstop_NoResults_InvalidFilter_$System:Hour.Number:toString$.$System:Minute.Number:toString$.$System:Second.Number:toString$.png%3B"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$vEmailExceptionBody_BackstopNoResultsReturned$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"236f15c3-405e-4216-831c-0cf72f48f083","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Data was not found on $vBackstop_PageFlag$ Page for $sBackstopFileName$."}}],"returnTo":{"type":"VARIABLE","variableName":"vExceptionMessage"}},{"uid":"7ac6b361-beea-49c8-931a-7b0cc35a9869","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,NA,$vExceptionMessage$,$m-string-1$,$m-string-2$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"88c397d7-ca50-422a-8052-e4dbfedbf258","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFileName$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vExceptionsFromBot$\\$sBackstopFileName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"16730081-10a6-457d-814c-6c1fe98378ce","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vReadyForBotFolder$/$sBackstopFileName$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6d7a58d4-e1ce-4064-b12c-05420ea6ec42","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"$sBackstopFileName$ - PDF Name Moved to exceptions folder\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0855f459-d84f-4c50-ae08-a0c122e0e335","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Bot Error"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBackstopResponse$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"html"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"783c8265-f510-4f8e-b1e6-5eac5719c815","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vOutputPath$\\PI_$vBackstopAccountId$_$vBackstopNoticeId$.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"sOutputFilename"}},{"uid":"79e4b4d6-6537-41ea-b2e0-c365dff49e4b","commandName":"clear","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}}]},{"uid":"0a0fd2c2-4d5a-45a3-ac17-8c820757281e","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sBackstopResponse"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"f876c367-444b-4f04-9a94-009e7f858a23","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lPythonList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sOutputFilename"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]},{"uid":"77187886-9c58-4cd6-bdf3-8a8f8b20ab7e","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"c6f08323-cda0-4ff8-aa95-9a37447ec9f5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Converting to TRSS XLSX "}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"06a33976-1561-4d4e-9e3c-1985e1d4d914","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"23098a04-ae48-45db-bcba-3dfed1f22f87","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"BackstopJsonToExcelPI"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"lPythonList"}}]},{"uid":"f72c167f-a998-45d6-8c81-39a021dfe46c","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"48c023bb-6150-49c9-a9eb-c55ae52420ef","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Acquiring Files From Backstop - COMPLETED"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"809e8ac7-dd2c-451c-be89-4a54d7c31fb9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Info"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"d5455798-f858-47f0-afa9-0889a53595aa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"c40fc8fc-7d38-44cd-989f-95ea1a2ff207","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4984bc73-926a-4f04-9e5a-123f87dfc2c9","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"5d9d9e7b-ab40-4613-92cc-865ccdd3d8cf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),\"General Exception, raise exception, move file and move to next file\",$m-string-1$,$m-string-2$,Exception"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9a06ef05-3089-4eda-859f-e1f4edc81aa1","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","string":"C:\\ProgramData\\AutomationAnywhere\\Error Handling"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"0fd37f9f-c24b-4ff2-8e7b-b599040915d9","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"674c480d-21a5-45d5-bb9a-038c04906a80","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"bTaskStatus"}},{"uid":"95aea124-1c74-4afb-897b-1a85c6e4cb27","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"170b340d-94a9-43fd-aedc-0b37e9d51d52","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vProcessName$: Unexpected exception"}},{"name":"attachmentsFilePath","value":{"type":"FILE","string":"file:///C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png%3BC%3A/ProgramData/AutomationAnywhere/Error%20Handling/Error%20Message.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"3b939636-45c2-4b77-992a-82e33fdcc263","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png"}}]},{"uid":"502cc059-2b4f-46b6-8633-1cdd64c9c5e8","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error%20Message.txt"}}]},{"uid":"74779d4e-c1d8-4ade-8176-83b6a37c970a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"5aaf17cd-ebb6-4716-8da5-45c329f1f358","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"cda6b880-2eb4-408a-9a15-d17fefbed131","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ecd66d3e-9166-42ec-8054-f6b0d6153d03","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vBackstopUser","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBackstopToken","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBackstopAccountId","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sOutputFilename","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sOutputPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vRPAFolderPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"\\\\sbafshare\\RPA"}},{"name":"vCurrentEnvironment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vProcessName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vEmailFrom","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLogPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vPathExists","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogMessage","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"vRPAsupportEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"m-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"vProcessDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMonth","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vProcessStartTime","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInputPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vOutputPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAuditLogPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorScreenshotPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLogFilename","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAuditLogFilename","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorScreenshotFilename","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAuditLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorScreenshot","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"m-string-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"fBackstopTRSS","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBackstopNoticeId","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"dtLastMonthLastDay","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"sPrevMonthLastDay","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"fBackstopPI","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sBackstop_Username","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sBackstop_Token","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sBackstopJSON","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"bTaskStatus","description":"","type":"BOOLEAN","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"sBackstopResponse","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sOutputFullFilename","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"bOutputFile","type":"BOOLEAN","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"bIsStandalone","description":"","type":"BOOLEAN","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"my-list-variable","type":"LIST","subtype":"STRING","sessionType":"","input":false,"output":false,"constant":false},{"name":"vBackstop_RetryAttempts","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_BackstopMissingExcelDownload","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_BackstopNoResultsReturned","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailToBusiness","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_BackstopNoResultsReturned","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vErrorScreenshotsPath","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_BackstopFiltersInvalid","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vBackstopHome","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_BackstopMissingExcelDownload","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vErrorFlag","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailToRPASupport","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_BackstopLoginFailure","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vReadyForBotFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vExceptionsFromBot","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_BackstopLoginFailure","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vCompletedByBot","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vBackstop_DETAIL_URL","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_MissingDetailTab","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_BackstopNoDetailResultsReturned","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_BackstopNoDetailResultsReturned","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionBody_DateMismatch","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"vEmailExceptionSubject_DateMismatch","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"M-CPU-Usage-StringVal","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"lPythonList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"vBackstop_PageFlag","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vExceptionMessage","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sBackstopFilename","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTempPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAuditLogPath","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrorLogPath","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sBackstop_Url","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["1a9ec2da-e115-4f55-89c0-deffd4cf9119","74983b6f-fe23-42cc-a8ed-38f3c47293b9","caec0338-080a-4f74-a45f-e0ae1f058881","f71a8564-a59d-49fb-b47f-87790bd0419c"],"packages":[{"name":"Boolean","version":"2.1.0-20210504-152757"},{"name":"Boolean","version":"2.1.0-20210504-152757"},{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"Datetime","version":"2.2.0-20210504-152815"},{"name":"Datetime","version":"2.2.0-20210504-152815"},{"name":"Delay","version":"3.2.0-20211011-141700"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"LogToFile","version":"3.0.0-20210504-152939"},{"name":"LogToFile","version":"3.0.0-20210504-152939"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"Python","version":"2.9.0-20211016-065947"},{"name":"Screen","version":"2.2.0-20210504-153440"},{"name":"Screen","version":"2.2.0-20210504-153440"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"TaskBot","version":"2.0.1-20210503-140009"},{"name":"TaskBot","version":"2.0.1-20210503-140009"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}