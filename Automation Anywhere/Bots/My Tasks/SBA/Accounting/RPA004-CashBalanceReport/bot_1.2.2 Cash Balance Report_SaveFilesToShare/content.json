{"triggers":[],"nodes":[{"uid":"5b6389e9-3f15-4bf8-8e8e-2102adf4999b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"fb60161b-ee29-47b1-9c81-8e35392520bc","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Name: 1.2.0 Cash Balance Report Save Files To Share"}}]},{"uid":"dc1a27a1-60c4-4d6e-badd-ea2866ce6751","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Description: Moves the constructed files from Input to Output, then copies them from Output to the Share with the correct name."}}]},{"uid":"3c4861a5-5549-42b1-965b-ff9d83faad0e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Task Dependecies: 1.0.0 Cash Balance Report_MasterTask"}}]},{"uid":"a363ab6c-ae60-45e7-8cf7-b1daf9c7d671","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Modified By: Jason Verschage"}}]},{"uid":"e7fcf4ab-c63d-4b70-9f96-7e0ec3ceffb5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Last Date Modified: 8/17/2020"}}]},{"uid":"0edf1cbc-cb34-44a2-b1f8-9d470aab4105","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"894360d8-8910-4121-80a8-bcaf949e4f55","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Confirm Output Directory Exists"}}]},{"uid":"49d17381-47ca-40ea-90e6-506c85b42b59","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"b9e4f307-060c-40fc-906f-7d4b0321d8bc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTaskStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"09f3ec70-9c85-4b81-b2cb-07b0bbad98aa","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Info"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"5989c24d-5eec-4515-a2ca-0aa78adcc73b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"e31f3d1c-df19-48ea-aae7-62f755fd02c5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Copy Modified Files to Output Directory and Share Drive\n---- BEGIN ----"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"e02e6e66-50e9-4c72-85b6-6aeac0299e7e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogMessage.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"a462f4e4-91e6-415f-9691-cb8ae6b84e1e","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"ba7032b0-b5a5-427b-83cf-6314ee09d3bb","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"39d7eecd-dbee-4432-ad14-9cd1b6574dde","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"c23e23c3-2ffe-4224-bd42-86825294fb5e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"709e9abc-08fb-4eb0-a167-af0ab91915c8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"10c77381-3a71-4ad9-8c00-aac34f97713c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"9dd9807d-93dc-4ffa-a3bf-36fe96df7827","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ce689ad4-0977-48c8-b357-64d0e202157a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"3399ece8-5c54-43a7-9345-d39a906d1b4e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"We only want to move the files with the extension of xlsx."}}]},{"uid":"48c6e0f9-1529-4788-bfae-c857b93a6082","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"451a8b59-a171-4593-9aa6-70170a0d5935","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"AA doesn't have a File Move function.  We have to copy and delete."}}]},{"uid":"824a929f-8635-4b63-b71d-608685b7847c","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"$vOutputPath$\\$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vInputPath$/$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"04bc7c1b-a233-4b96-9d2e-e4c3a46fe0fe","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vInputPath$/$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$Loop-Files-1{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"xlsx"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}],"attributes":[{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vInputPath$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]},{"uid":"e2a53daa-d917-4450-862f-73346a34d692","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Confirm Output Share Exists"}}]},{"uid":"848dbff7-f301-4664-af79-7776735599e6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**** UPDATE - Change to use the file list file for output directories."}}]},{"uid":"ebdbef48-92e6-472c-95cd-5d7cf1031bd2","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"f0d6ad33-33f4-4652-8681-4ed061aa9851","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"FileList"}},{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Docs/SBA/Accounting/RPA004-CashBalanceReport/RPA004-FileList-Test.csv"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"ansi"}}]}],"branches":[{"uid":"8ea6023e-e914-45a7-84ab-67a16c9c16e5","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"1b708020-af39-4583-a5e6-e6f91496dc16","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"FileList"}},{"name":"filePath","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Docs/SBA/Accounting/RPA004-CashBalanceReport/RPA004-FileList-Prod.csv"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"ansi"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileListFilename$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"RPA004-ListFile-Prod.csv"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileListFilename$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"RPA004-FileList-Test.csv"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"fbdffc87-5b0c-40f3-b033-ce25899af21c","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"FileList"}}],"returnTo":{"type":"VARIABLE","variableName":"CSV-TXT-FileList-DATA"}},{"uid":"72c5665d-c6be-477d-badc-4f10955e9779","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"FileList"}}]},{"uid":"970f22f5-6436-4c9a-a510-fe025a8951fa","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"8a63c62e-02ae-45b2-a7fb-9a10d2c6e36e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"1c6e11f4-a95c-4924-8d67-7b04bd24a7b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"e60afb96-87bd-4d5b-8a61-a007d67cb26a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"986fe244-f50d-454f-bfac-56dbf10ef2fd","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]},{"uid":"b9a5919c-7c80-483d-b8f1-fbc7cad37584","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[0]$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"Filename"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"90915546-56dc-4ef4-a5e2-4557d5db7f29","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileName"}},{"uid":"c11ef4d8-a1ad-4818-943b-65734d234373","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileTransferDir"}},{"uid":"26b38705-aebf-4e06-955f-555b2897f10d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[3]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTempEmailAddress"}},{"uid":"158a5a59-5e5b-47ba-8413-b8dd25390ff0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ad448f22-127d-4a11-babb-dfc678461128","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**** At least set vFileEmail to temp value ****"}}]},{"uid":"a43eab19-42cc-415c-a0c7-7147e3a6fb70","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"48f0a39e-2002-4f84-8b93-50234e6977d7","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**** Send Email if vFileEmail is not blank ****"}}]},{"uid":"41354173-e98d-4d6a-85e5-1cc82485a4c4","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileListStringForEmail$"}},{"name":"delimiter","value":{"type":"STRING","string":"|"}},{"name":"limit","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"my-list-variable"}},{"uid":"39efb32b-98cf-4604-b3e1-918fb1e613c6","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vFileEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"File Transfer Complete"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"The folllowing files for RPA004 have been transferred:<BR><BR>$vFileListStringForEmail$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"mail.sbafla.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"5ad3d45e-cb30-4952-8f4e-3aa4e7e7d625","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}},{"uid":"83cc0254-1f3b-4ae2-a24a-b0cbc72c48b4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileListStringForEmail.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileEmail$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"bdecee90-18aa-4e80-9e6a-5b188d7f9918","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTempEmailAddress$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileEmail"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileEmail$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","expression":"$vTempEmailAddress$"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"991be47f-1551-40e4-92f0-276ccbb2218b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"9a0ef421-496e-45b6-b4f6-5fc26847abaf","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Check the file prefix and pull the date from the vStartDates variable"}}]},{"uid":"78d4f08c-a08a-4e73-8353-a35a85e91b98","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vRow"}},{"uid":"4dc661f6-9c5f-4590-803d-94f553b9e8f7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vRow.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vRow"}},{"uid":"316111f5-1bc5-414d-a142-98bbe7b8a426","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileStart"}},{"uid":"54889f2c-c6f5-4f31-bb13-dc3fdac2a027","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputFormatDate"}},{"uid":"964e16c7-6d82-4435-9afb-443f83535615","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vOutputFormatDate.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputFormatDate"}},{"uid":"df824978-0e59-45a6-aefa-3a6e5a9c0640","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"bba2a8a4-db74-4c06-874d-28c12da74787","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"3cf39fbc-a2f1-4ba3-ba25-81d33994def1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-2.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-2"}},{"uid":"8d85d13c-534c-4926-862b-704846c8644f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter your commands to loop."}}]},{"uid":"86835096-313f-49e2-b707-fce23888cfac","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"94877024-031a-451c-a8aa-0ec91d3f5f0c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]},{"uid":"356a504c-ebad-4721-b21d-a017ba6a7fbf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vStartDates[$vRow.LegacyAutomation:getDecrementedNumber$][1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputFormatDate"}},{"uid":"256e5cfa-e01d-463b-be8c-27d5084a7161","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vOutputFormatDate.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputFormatDate"}}],"branches":[{"uid":"71453770-ff85-4142-b7df-713bb68bef4f","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"bf112b29-6544-49c6-acea-e9ca4c537761","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vRow$ + 1"}}],"returnTo":{"type":"VARIABLE","variableName":"vRow"}},{"uid":"8b73a858-fbc8-4e02-af52-a8939ca65ee8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vRow.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vRow"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vStartDates[$vRow.LegacyAutomation:getDecrementedNumber$][0]$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","expression":"$vFileStart$"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}],"attributes":[{"name":"iterator","attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$vStartDates.DataTable:rowCount$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]},{"uid":"28335274-ce3f-4c32-a97f-8b5bc8be1ce5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"bafcf9f7-29f0-43ba-ba88-70a4f4b0a889","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Copy From Output to Output Share"}}]},{"uid":"8e7c93c6-1cdf-4a26-a62b-230f11e7468a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileTransferDir$\\$vOutputFormatDate$_$vFileName$.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"vNewFilename"}},{"uid":"d68c0900-6f39-4946-a914-5f9ae0944594","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNewFilename.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNewFilename"}},{"uid":"c3d8e84b-dccc-40e9-8c1d-ccb96c7c466d","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNewFilename$"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"SOURCE"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":""}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"vNewFilename"}},{"uid":"ddd2b6d4-dfb0-4dc2-b2e6-6f4e4c0569e1","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"destinationPath","value":{"type":"STRING","expression":"$vNewFilename$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vOutputPath$/$vFileName$.xlsx"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vOutputFormatDate$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"42ebcb5f-2bcc-4725-a787-ad161e3833f6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vNoData"}},{"uid":"e3e4359a-36d9-4fb6-8a75-5ae5404d5a19","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNoData.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNoData"}},{"uid":"bd3bf6a2-0532-432c-83ed-a0f6814dfd66","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"add9d035-c0f5-49a9-acbb-c67530c6e711","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]},{"uid":"1a615498-9855-4f66-b4c2-0a34235edd9a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"(No Data for this file)"}}],"returnTo":{"type":"VARIABLE","variableName":"vNoData"}},{"uid":"b2c8ac58-f6e0-4e14-bd0b-bf9a124426bc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vNoData.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vNoData"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vOutputFormatDate$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"ND"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"0b874c0c-191b-4808-b89d-1b805401fcda","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6ecc7bef-0061-4928-a4c7-36290262befe","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileName$ $vNoData$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}},{"uid":"88a4f8ea-8ee1-4ad9-b63a-10253b7f17d2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileListStringForEmail.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}}],"branches":[{"uid":"64dd2b08-1f4b-4b64-9caf-a65a1c96f12a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"05f38c1d-e5a7-4603-abf5-c0190d2f6e67","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileListStringForEmail$<br/>$vFileName$ $vNoData$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}},{"uid":"721030f0-c7dd-40b5-ab25-bb0add95b86d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileListStringForEmail.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileListStringForEmail"}},{"uid":"a7b77e4d-1f00-4f28-9aca-983074330d30","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileListStringForEmail$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}],"branches":[{"uid":"38cc6544-0cd0-401e-8483-2569b57236b3","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7fb54aca-b08a-4756-b326-12032d9f3e0c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Error"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"82304e9f-c11b-42c8-a14c-595644a58a2d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"5398f91c-74de-4c99-95eb-dbc378da4013","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Output Share Drive from Property File Could Not Be Found"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"4931134d-f467-489b-bc16-f4476ae92346","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogMessage.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"c91a45d2-6029-436c-a986-e0e1cac1005f","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"4cef1641-651d-47ed-bc91-32b2b0dfaea9","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"e71bb379-5eed-4bda-b38f-3cb76fc3cbb1","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"6d071f38-7196-4f28-b060-77fd534be8ec","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ad67af07-df5b-44ac-9d32-03d49762e46a","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"32ce32cb-6bd9-47f8-970a-ed66d06f2cdc","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"RPA004 SBA Cash Balance Report - Error: Output Share Not Found"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"\"Hello, \n\nError: Ouptut Share Drive Not Found\n\nThe SBA Cash Balance (RPA004) bot has processed the files and placed them in the Output Folder, but could not move them to the share.  Please manually copy them from $vOutputPath$ to the correct directory when available, and review the bot's drive settings.\n\nTask Name: $System:AATaskName$\nDate and time: $m-date-string$ \nUsername: $System:AATaskInvoker{\"Invoker_UserName\"}$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"mail.sbafla.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"b3672d06-544f-433d-a7e3-917f92f2a38b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"eefc5fe3-ba3e-4893-ae26-4a9f8b42959c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTaskStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFileTransferDir$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]}],"attributes":[{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"Loop-Filedata-Column-1"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"CSV-TXT-FileList-DATA"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]},{"uid":"31f14c37-77b3-4e25-b32e-f0fb2edb27c8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6e5d6ded-a51a-4154-8e68-5656fd83b8a4","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"**** Send Email if vFileEmail is not blank ****"}}]},{"uid":"d33cda50-d1c6-4450-81b7-a537ebe6879d","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vFileEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"File Transfer Complete"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"The folllowing files for RPA004 have been transferred:<BR><BR>$vFileListStringForEmail$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"mail.sbafla.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileEmail$"}},{"name":"operator","value":{"type":"STRING","string":"DoesNotEqualTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"45ac2bf7-0277-4608-81ba-344f5364a1eb","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Copy From Output to Output Share"}}]},{"uid":"3c91efda-d871-4897-ad80-d42c78a4fdbe","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Copy Modified Files to Output Directory and Share Drive\n---- END ----"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"a368e820-c8f6-4840-b7dd-60e50acb09f6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogMessage.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"a1585783-3ee5-42d5-9bc6-84afbfabe6e1","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"ca95196c-51c1-4f0d-a24d-6a08178da9a8","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"fa09c8d0-0b23-4910-bea1-0425132fad7e","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"8e51c113-1baa-4dab-bd5a-78c4523e72a3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"deeaa4a0-4afd-48fb-baf0-498415ffc857","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"bda71832-b193-4476-856c-02d9a9fa25d4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Error"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"98de160b-4e81-4032-a282-89df8c9b829e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogStatus"}},{"uid":"01cfef46-704b-4c14-9394-523d9709ecf0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Output Local Drive Could Not Be Found"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"7c92654b-fd25-4048-8f42-5a198077628c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vLogMessage.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogMessage"}},{"uid":"343cc398-82e5-42e0-acba-249433148282","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"4280bc44-1c50-46a9-9a69-03d2e86ff783","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"USERNAME","label":"USERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"523a0210-bd97-4baf-8f66-96cf8133d65d","commandName":"systemInformation","packageName":"System","disabled":false,"attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-2"}},{"uid":"d75b53c2-48e6-4768-a3fc-0ccfcc5a07cc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"($m-date-string$),$vLogMessage$,$m-string-1$,$m-string-2$,$vLogStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8ee9a9c2-141c-4095-85c9-a2d45c4b1228","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"a1ede02d-6217-4844-a874-62db159d6f63","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"RPA004 SBA Cash Balance Report - Error: Output Share Not Found"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"\"Hello, \n\nError: Ouptut Share Drive Not Found\n\nThe SBA Cash Balance (RPA004) bot has processed the files but the local Output Drive could not be found.  Move the files from the $vInputPath$ to the Output Share, and confirm the missing output drive.\n\nTask Name: $System:AATaskName$\nDate and time: $m-date-string$ \nUsername: $System:AATaskInvoker{\"Invoker_UserName\"}$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"mail.sbafla.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"cc936da1-01b1-45d9-b268-095d06dbdac8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"58b8e11c-d3d9-4632-a102-99b0e0d5e10b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTaskStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vOutputPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]}],"branches":[{"uid":"b6eac3f7-5b19-4b13-9ce2-d9674a3394f1","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7ee5900e-c726-48e6-87b2-55beb842d599","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"88eb4c4c-76a6-4dab-82d6-a1ff72b391e4","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","string":"C:\\ProgramData\\AutomationAnywhere\\Error Handling"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"89e85fc0-16ac-4f07-9e4f-918ffa00776a","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"448f0729-53a1-436f-8f59-5521d0068dd5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"e665d389-fbd6-42b5-8b77-5c073df7d3cc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Failed"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"d0a0459f-943c-445d-9dd2-a1ce6fff47a3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTaskStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskStatus"}},{"uid":"d27c5908-abce-46ef-8cd9-f49824828964","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"b60b0376-79d2-447f-b246-069aa2fe4f07","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vRPAsupportEmail$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$vProcessName$: Unexpected exception"}},{"name":"attachmentsFilePath","value":{"type":"FILE","string":"file:///C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png%3BC%3A/ProgramData/AutomationAnywhere/Error%20Handling/Error%20Message.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmailFrom$"}},{"name":"emailServerHost","value":{"type":"STRING","string":"mail.sbafla.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"4cf492d2-df7b-49fd-843d-e67838fb73e3","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error.png"}}]},{"uid":"53b1259c-09fd-40f3-9591-9648874f72cd","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://C:/ProgramData/AutomationAnywhere/Error%20Handling/Error%20Message.txt"}}]},{"uid":"aa1b8dbe-b5a1-4e2f-bd48-6caf73577d9e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"026cb2a2-e385-4f2c-bb04-f28a611e29ce","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"516e334c-9a5c-4a79-9094-ce409223ab3b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"676a0b91-8f8e-48a0-add3-1bcf4b06dfb6","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vProcessName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileStart","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRow","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"1"}},{"name":"vDateFormatArray","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"vTempString","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDay","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vOutputDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"7/8/2020"}},{"name":"vDayLength","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMonthLength","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vOutputFormatDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vMonth","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vYear","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vIncomingFileBase","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNewFilename","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vInputPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vStartDates","description":"","type":"TABLE","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"name":"","type":"STRING"},{"name":"","type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]},{"values":[{"type":"STRING","string":""},{"type":"STRING","string":""}]}]}}},{"name":"vOutgoingFileSharePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vOutputPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vAuditLog","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogMessage","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vRPAsupportEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vEmailFrom","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vProcessEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vConfigPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileListFilename","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileTransferDir","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileListStringForEmail","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTempEmailAddress","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vNoData","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Loop-Filedata-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Filedata-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"CSV-TXT-FileList-DATA","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-2","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210504-152757"},{"name":"CsvTxt","version":"2.4.0-20210504-152806"},{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"DataTable","version":"2.8.0-20210504-153459"},{"name":"Datetime","version":"2.2.0-20210504-152815"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"LogToFile","version":"3.0.0-20210504-152939"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"Screen","version":"2.2.0-20210504-153440"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"TaskBot","version":"2.0.1-20210503-140009"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","botCodeVersion":"1"}}